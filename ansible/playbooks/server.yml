---
- name: Deploy Kubernetes cluster (k3s)
  import_playbook: k3s.yml

- name: Provision server with Home Assistant, Dashy, and Grafana
  hosts: server
  become: true
  roles:
    - tools/docker
    - apps/helm
    - apps/kubectl
    - apps/oh_my_zsh

- name: Deploy Home Assistant
  import_role:
    name: server/home_assistant

- name: Deploy Dashy
  import_role:
    name: server/dashy

- name: Deploy Grafana
  import_role:
    name: server/grafana

- name: Configure Firewall
  import_role:
    name: server/firewall
